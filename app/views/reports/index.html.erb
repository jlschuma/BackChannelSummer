<% provide(:title, 'Administrator Reports') %>
<%
  top_post_limit = 10
  top_user_limit = 10
%>

<div class="reports-index">

<h2>Top <%= top_post_limit %> posts</h2>
<table>
<thead>
  <tr>
    <th>Post ID</th>
    <th>Post Time</th>
    <th>Author</th>
    <th># Comments</th>
  </tr>
</thead>
<tbody>
  <% 
    @posts[0..top_post_limit-1].each do |post|
  %>
    <tr>
      <td><%= link_to post.id, post %></td>
      <td><%= post.created_at.strftime "%B %d, %Y %l:%M %p" %></td>
      <td><%= link_to post.user.email, post.user %></td>
      <td><%= post.comments.length %></td>
    </tr>
  <% end %>
</tbody>
</table>

<h2>Top <%= top_user_limit %> posters</h2>
<table>
<thead>
  <tr>
    <th>Author</th>
    <th>Joined</th>
    <th># Posts</th>
  </tr>
</thead>
<tbody>
  <% 
    @users[0..top_post_limit-1].each do |user|
  %>
    <tr>
      <td><%= link_to user.email, user %></td>
      <td><%= user.created_at.strftime "%B %d, %Y" %></td>
      <td><%= user.posts.length %></td>
    </tr>
  <% end %>
</tbody>
</table>

</div>